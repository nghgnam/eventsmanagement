<div class="container">
    <form action="" [formGroup]="registerForm" (ngSubmit)="onSubmit()" class="register-form">
      <h1>Create an account</h1>

      <!-- Error Message -->
      @if (errorMessage) {
        <div class="error-message">
          <i class="fa-solid fa-circle-exclamation"></i>
          <span>{{ errorMessage }}</span>
        </div>
      }

      <!-- Loading Spinner -->
      @if (isLoading()) {
        <div class="loading-overlay">
          <div class="spinner"></div>
          <p>Creating your account...</p>
        </div>
      }
  
      <div>
        <mat-form-field appearance="outline">
  
          <mat-label> Email </mat-label>
  
          <input matInput formControlName="email" placeholder="Enter your email" type="text" />
          <span matSuffix>
            <i class="fa-solid fa-envelope" matSuffix></i>
          </span>
  
  
          @if (registerForm.controls['email'].invalid && registerForm.controls['email'].touched) {
            <mat-error>
              @if (registerForm.controls['email'].errors?.['required']) {
                <span>Email is required</span>
              }
              @if (registerForm.controls['email'].errors?.['email']) {
                <span>Invalid Email address</span>
              }
            </mat-error>
          }
  
        </mat-form-field>
      </div>
  
      <div>
        <mat-form-field appearance="outline">
  
          <mat-label> Password </mat-label>
  
          <input matInput formControlName="password" placeholder="Enter your password"
            [type]="showPassword ? 'text' : 'password'" />

          <span matSuffix>
            <i class="fa-solid" [class.fa-eye-slash]="!showPassword" [class.fa-eye]="showPassword"
              (click)="togglePasswordVisibility()"></i>
          </span>
  
          @if (registerForm.controls['password'].invalid && registerForm.controls['password'].touched) {
            <mat-error>
              @if (registerForm.controls['password'].errors?.['required']) {
                <span>Password is required</span>
              }
              @if (registerForm.controls['password'].errors?.['pattern']) {
                <span>Password must be at least 8 characters long and contain at least one uppercase letter, one lowercase letter, one number, and one special character</span>
              }
            </mat-error>
          }
  
        </mat-form-field>
  
  
  
      </div>
      <div>
        <mat-form-field appearance="outline">
  
          <mat-label> Confirm Password </mat-label>
  
          <input matInput formControlName="repassword" placeholder="Enter your confirm password"
            [type]="showPassword ? 'text' : 'password'" />

          <span matSuffix>
            <i class="fa-solid" [class.fa-eye-slash]="!showPassword" [class.fa-eye]="showPassword"
              (click)="togglePasswordVisibility()"></i>
          </span>
  
          @if (registerForm.controls['repassword'].invalid && registerForm.controls['repassword'].touched) {
            <mat-error>
              @if (!isPasswordMatch() && registerForm.controls['repassword'].touched) {
                <span>Passwords do not match</span>
              }
            </mat-error>
          }
  
        </mat-form-field>
  
      </div>
  
  
      <div>

        <button mat-raised-button color="primary" type="submit" [disabled]="registerForm.invalid || isLoading()">
          @if (!isLoading()) {
            <span>Sign up</span>
          }
          @if (isLoading()) {
            <span>
              <i class="fa-solid fa-spinner fa-spin"></i> Creating account...
            </span>
          }
        </button>

      </div>
  
  <!--
      <div class="line"></div> -->
  
      <div class="divider margin-y_24">
        <span class="or-span">OR Continue with</span>
      </div>
      <div>
  
        <a mat-raised-button (click)="loginWithGoogle()" class="google-button">
          <i class="fa-brands fa-google"></i>
          <p>Continue with Google </p>
        </a>
      </div>

      <div class="login-link">
        <p>Already have an account? <a [routerLink]="['/login']">Sign in</a></p>
      </div>
    </form>
  </div>
  
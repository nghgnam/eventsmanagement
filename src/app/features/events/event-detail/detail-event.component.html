@if (event) {
  <div class="details_container">
    <!-- Hero Section with Background Image -->
    <div class="events_background">
        <div class="events_background2" [style.background-image]="'url(' + getEventImage(event) + ')'"></div>
        <img [src]="getEventImage(event)" [alt]="event.core.name || 'Event image'" class="background_details">
    </div>

    <!-- Main Content -->
    <div class="events_details">
        <!-- Event Information -->
        <div class="event_infomation">
            <!-- Event Date and Title -->
            <div class="event_header">
                <div class="event_date">
                    <i class="fa-solid fa-calendar-days"></i>
                    <span>{{ showStartTime | date: 'EEEE, MMMM d' }}</span>
                </div>
                <h1 class="event_title">{{ event.core.name }}</h1>
                <div class="event_type_badge" 
                     [class.online]="getEventType(event) === 'online'"
                     [class.offline]="getEventType(event) === 'offline'"
                     [class.hybrid]="getEventType(event) === 'hybrid'">
                    <i class="fa-solid" 
                       [class.fa-video]="getEventType(event) === 'online'"
                       [class.fa-location-dot]="getEventType(event) === 'offline'"
                       [class.fa-desktop]="getEventType(event) === 'hybrid'"></i>
                    {{ getEventType(event) }}
                </div>
            </div>

            <!-- Organizer Info -->
            <div class="about_organizer">
                <div class="organizer_avatar">
                    <img
                        [src]="getOrganizerImage(event)"
                        [alt]="event.organizer?.name || 'Organizer'">
                </div>
                <div class="organizer_info">
                    <span style="font-weight: 600;">By</span>
                    <p>{{ event.organizer?.name }}</p>
                    <span>-</span>
                    <p>{{ event.organizer?.followers }}</p>
                    <span style="font-weight: 600;">followers</span>
                </div>
                <button (click)="actionFollow()" [disabled]="isFollowLoading || isOrganizer" [class.active]="hasFollow"
                    class="organizer_follow">
                    @if (!isFollowLoading) {
                      {{ hasFollow ? 'Hủy theo dõi' : 'Theo dõi' }}
                    } @else {
                      Đang xử lý...
                    }
                </button>
            </div>

            <!-- Event Description -->
            <div class="event_description">
                <p>{{ getEventDescription(event) }}</p>
            </div>

            <!-- Date and Time Selection -->
            <div class="section_title">
                <h2>Select Date & Time</h2>
                <p class="section_subtitle">Choose your preferred event schedule</p>
            </div>
            <div class="event_date_time_options">
                <div class="selected_date_and_time">
                    <div class="selected_date_icon">
                        <i class="fa-solid fa-calendar-days"></i>
                    </div>
                    <div class="selected_date_text">
                        <h3>Selected Schedule</h3>
                        <p>{{ showStartTime | date : "EEEE, MMMM d, y" }}</p>
                        <p class="time_range">{{ showStartTime | date : "h:mm a" }} - {{showEndTime | date : "h:mm a"}}
                        </p>
                    </div>
                </div>
                <div class="selected_date_and_time_container">
                    <h3 class="available_schedules">Available Schedules</h3>
                    <div class="date_time_options_grid">
                        @for (datetime of getScheduleOptions(event); track i; let i = $index) {
                          <div class="selected_options_date_and_time" 
                               (click)="getDatetimeClick(i)" 
                               [class.active]="activeBorder === i">
                            <div class="date_time_card">
                                <div class="date_time_header">
                                    <span class="date_day">{{ getOptionDate(datetime, 'start') | date : "EEEE"}}</span>
                                    <span class="date_month">{{ getOptionDate(datetime, 'start') | date : "MMMM"}}</span>
                                </div>
                                <div class="date_time_body">
                                    <span class="date_number" [class.selected]="isClickActive === i">{{ getOptionDate(datetime, 'start') | date : "d"}}</span>
                                    <span class="date_year">{{ getOptionDate(datetime, 'start') | date : "y"}}</span>
                                </div>
                                <div class="date_time_footer">
                                    <i class="fa-regular fa-clock"></i>
                                    <span class="time">{{ getOptionDate(datetime, 'start') | date : "h:mm a" }}</span>
                                </div>
                            </div>
                          </div>
                        }
                    </div>
                </div>
            </div>

            <!-- Location -->
            <div class="section_title">
                <h2>Location</h2>
            </div>
            <div class="event_location">
                <i class="fa-solid" [class.fa-video]="event.location?.type === 'online'" [class.fa-location-dot]="event.location?.type === 'offline'"></i>
                <span>{{ event.location?.type === 'online' ? 'Online Event' : event.location?.address }}</span>
            </div>

            <!-- About Event -->
            <div class="section_title">
                <h2>About this event</h2>
            </div>
            <div class="event_about">
                <p>{{ getEventContent(event) }}</p>
            </div>

            <!-- Tags -->
            @if (getEventTags(event).length > 0) {
              <div class="section_title">
                <h2>Tags</h2>
              </div>
              <div class="event_tag">
                @for (tag of getEventTags(event); track tag) {
                  <p>{{tag}}</p>
                }
              </div>
            }

            <!-- Organizer Details -->
            <div class="section_title">
                <h2>Organized by</h2>
            </div>
            <div class="host_organized_about">
                <div class="host_header">
                    <img
                        [src]="getOrganizerImage(event)"
                        [alt]="event.organizer?.name || 'Organizer'" class="host_avatar">
                    <div class="host_info">
                        <p class="host_name">{{event.organizer?.name}}</p>
                        <p class="host_follower">{{event.organizer?.followers}} followers</p>
                    </div>
                </div>
                <p class="host_about">This is About Organized</p>
            </div>

            <!-- More Events from Organizer -->
            @if (events$ | async; as events) {
              <div class="section_title">
                <h2>More events from this organizer</h2>
              </div>
              <div class="events_other">
                @for (e of events; track e.id) {
                  <div class="event_other">
                    @if (event.organizer && e.organizer?.name === event.organizer.name) {
                      <div class="event_other_block" (click)="goToDetail(e.id)">
                        <div class="event_other_image">
                            <img [src]="getEventImage(e)" [alt]="e.core.name || 'Event'">
                            <div class="event_other_date">
                                <span class="day">{{ getOptionDate(getScheduleOption(e,0), 'start') | date : "d"}}</span>
                                <span class="month">{{ getOptionDate(getScheduleOption(e,0), 'start') | date : "MMM"}}</span>
                            </div>
                        </div>
                        <div class="event_other_info">
                            <p class="event_other_title">{{e.core.name}}</p>
                            <p class="event_other_time">{{ getOptionDate(getScheduleOption(e,0), 'start') | date : "EEEE MMMM d ha"}}
                            </p>
                            <p class="event_other_price">{{ getPriceLabel(e) }}</p>
                            <p class="event_other_organizer">{{e.organizer?.name}}</p>
                        </div>
                      </div>
                    }
                  </div>
                }
              </div>
            }
        </div>

        <!-- Ticket Purchase Section -->
        <div class="get_ticket">
            <div class="ticket-card">
                <div class="ticket-header">
                    <div class="ticket-details">
                        <p class="ticket-type">General Admission</p>
                        <h3>{{ getEventStartDate(event) | date:'EEEE, MMM d' }}</h3>
                        <span class="ticket-time">
                            {{ getEventStartDate(event) | date:'shortTime' }} -
                            {{ getEventEndDate(event) | date:'shortTime' }}
                        </span>
                    </div>
                    <div class="ticket-price" [class.free]="isFreeEvent()">
                        <span class="price-amount">{{ getPriceLabel(event) }}</span>
                        <span class="price-note">{{ isFreeEvent() ? 'Free entry' : 'Per ticket' }}</span>
                    </div>
                </div>

                <div class="ticket-body">
                    <div class="ticket_quantity">
                        <span>Tickets</span>
                        <div class="quantity_controls">
                            <button class="decrease" (click)="deCreaseTicket()" [disabled]="totalTicket <= 1 || isFreeEvent()">
                                <i class="fa-solid fa-minus"></i>
                            </button>
                            <p class="total_ticket">{{ totalTicket }}</p>
                            <button class="increase" (click)="inCreaseTicket()" [disabled]="isEventFull">
                                <i class="fa-solid fa-plus"></i>
                            </button>
                        </div>
                    </div>
                    <div class="ticket-meta">
                        <div class="status-chip" [class.full]="isEventFull">
                            <i class="fa-solid" [class.fa-circle-check]="!isEventFull" [class.fa-triangle-exclamation]="isEventFull"></i>
                            <span>{{ isEventFull ? 'Event is full' : 'Spots available' }}</span>
                        </div>
                        @if (getSaleEndDate(); as saleEndDate) {
                          <div class="sale-end">
                              <i class="fa-solid fa-ticket"></i>
                              <span>Sale ends {{ saleEndDate | date:'MMMM d, y' }}</span>
                          </div>
                        }
                    </div>
                </div>

                <div class="ticket-actions">
                    @if (!hasSubscribes) {
                      <button class="reserve_a_spot" (click)="actionSubscribe()" [disabled]="isEventFull">
                        {{ isEventFull ? 'Event Full' : 'Reserve a spot' }}
                      </button>
                    } @else {
                      <button class="cancel_reservation" (click)="actionUnsubscribe()">
                        Cancel reservation
                      </button>
                    }
                    <button class="policy_toggle" (click)="isChecked()">
                        <i class="fa-solid" [class.fa-chevron-down]="isHidden" [class.fa-chevron-up]="!isHidden"></i>
                        {{ isHidden ? 'Show ticket policy' : 'Hide ticket policy' }}
                    </button>
                </div>

                @if (!isHidden) {
                  <div class="ticket-policy">
                      <p>
                        Tickets are reserved for {{ totalTicket }} attendee(s). 
                        {{ isFreeEvent() ? 'Free registrations are limited to one seat per user.' : 'Changes or refunds are not available after purchase.' }}
                      </p>
                      @if (getSaleEndDate(); as saleDate) {
                        <p>Sales will automatically close on {{ saleDate | date:'fullDate' }}.</p>
                      }
                  </div>
                }
            </div>
        </div>
    </div>
  </div>
}

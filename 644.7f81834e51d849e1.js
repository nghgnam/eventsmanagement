"use strict";(self.webpackChunkdonate_blood_project=self.webpackChunkdonate_blood_project||[]).push([[644],{5644:(mt,O,c)=>{c.r(O),c.d(O,{ManageEventsComponent:()=>ut});var _=c(467),M=c(3409),f=c(177),a=c(9417),G=c(9579),R=c(8455),k=c(6467),P=c(1038),C=c(152),F=c(3294),j=c(2910),$=c(1413),b=c(6977),N=c(8141),x=c(3273),e=c(6276),y=c(9040),S=c(5119),w=c(9837),I=c(199),D=c(2163);function Y(n,o){if(1&n&&(e.j41(0,"div",40),e.EFF(1),e.k0s()),2&n){const t=e.XpG(2);e.R7$(1),e.JRh(t.successMessage)}}function V(n,o){if(1&n&&(e.j41(0,"div",41),e.EFF(1),e.k0s()),2&n){const t=e.XpG(2);e.R7$(1),e.JRh(t.errorMessage)}}function U(n,o){if(1&n&&(e.j41(0,"div",37),e.DNE(1,Y,2,1,"div",38),e.DNE(2,V,2,1,"div",39),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.Y8G("ngIf",t.successMessage),e.R7$(1),e.Y8G("ngIf",t.errorMessage)}}function z(n,o){1&n&&(e.j41(0,"div",42),e.EFF(1," Event name is required "),e.k0s())}function X(n,o){1&n&&(e.j41(0,"div",42),e.EFF(1," Event name must be at least 3 characters "),e.k0s())}function A(n,o){1&n&&(e.j41(0,"div",42),e.EFF(1," Description is required "),e.k0s())}function L(n,o){1&n&&(e.j41(0,"div",42),e.EFF(1," Description must be at least 10 characters "),e.k0s())}function q(n,o){1&n&&(e.j41(0,"div",42),e.EFF(1," Content is required "),e.k0s())}function B(n,o){1&n&&(e.j41(0,"div",42),e.EFF(1," Start date is required "),e.k0s())}function W(n,o){1&n&&(e.j41(0,"div",42),e.EFF(1," End date is required "),e.k0s())}function H(n,o){1&n&&(e.j41(0,"div",42),e.EFF(1," Event type is required "),e.k0s())}function J(n,o){1&n&&(e.j41(0,"div",42),e.EFF(1," Address is required for offline/hybrid events "),e.k0s())}function Q(n,o){if(1&n&&(e.j41(0,"div",3)(1,"label",43),e.EFF(2,"Address *"),e.k0s(),e.j41(3,"div",5),e.nrm(4,"i",44)(5,"input",45),e.k0s(),e.DNE(6,J,2,0,"div",7),e.k0s()),2&n){const t=e.XpG();let r;e.R7$(6),e.Y8G("ngIf",(null==(r=t.eventForm.get("details_address"))?null:r.touched)&&(null==(r=t.eventForm.get("details_address"))||null==r.errors?null:r.errors.required))}}function Z(n,o){if(1&n&&(e.j41(0,"option",49),e.EFF(1),e.k0s()),2&n){const t=o.$implicit;e.Y8G("ngValue",t),e.R7$(1),e.SpI(" ",t.name," ")}}function K(n,o){1&n&&(e.j41(0,"div",42),e.EFF(1," District is required "),e.k0s())}function ee(n,o){if(1&n&&(e.j41(0,"option",49),e.EFF(1),e.k0s()),2&n){const t=o.$implicit;e.Y8G("ngValue",t),e.R7$(1),e.SpI(" ",t.name," ")}}function te(n,o){1&n&&(e.j41(0,"div",42),e.EFF(1," Ward is required "),e.k0s())}function ne(n,o){if(1&n&&(e.j41(0,"div",2)(1,"div",3)(2,"label",46),e.EFF(3,"Districts *"),e.k0s(),e.j41(4,"div",5),e.nrm(5,"i",47),e.j41(6,"select",48)(7,"option",49),e.EFF(8,"Select a district"),e.k0s(),e.DNE(9,Z,2,2,"option",50),e.k0s()(),e.DNE(10,K,2,0,"div",7),e.k0s(),e.j41(11,"div",3)(12,"label",51),e.EFF(13,"Wards *"),e.k0s(),e.j41(14,"div",5),e.nrm(15,"i",52),e.j41(16,"select",53)(17,"option",49),e.EFF(18,"Select a ward"),e.k0s(),e.DNE(19,ee,2,2,"option",50),e.k0s()(),e.DNE(20,te,2,0,"div",7),e.k0s()()),2&n){const t=e.XpG();let r,i;e.R7$(7),e.Y8G("ngValue",null),e.R7$(2),e.Y8G("ngForOf",t.districtsWithCities),e.R7$(1),e.Y8G("ngIf",(null==(r=t.eventForm.get("districts"))?null:r.touched)&&(null==(r=t.eventForm.get("districts"))||null==r.errors?null:r.errors.required)),e.R7$(7),e.Y8G("ngValue",null),e.R7$(2),e.Y8G("ngForOf",t.wardsWithDistricts),e.R7$(1),e.Y8G("ngIf",(null==(i=t.eventForm.get("wards"))?null:i.touched)&&(null==(i=t.eventForm.get("wards"))||null==i.errors?null:i.errors.required))}}function ie(n,o){if(1&n&&(e.j41(0,"option",60),e.EFF(1),e.k0s()),2&n){const t=o.$implicit;e.Y8G("value",t.name),e.R7$(1),e.SpI(" ",t.name," ")}}function re(n,o){1&n&&(e.j41(0,"div",42),e.EFF(1," Country is required "),e.k0s())}function oe(n,o){if(1&n&&(e.j41(0,"option",49),e.EFF(1),e.k0s()),2&n){const t=o.$implicit;e.Y8G("ngValue",t),e.R7$(1),e.SpI(" ",t.name," ")}}function se(n,o){1&n&&(e.j41(0,"div",42),e.EFF(1," City is required "),e.k0s())}function ae(n,o){if(1&n&&(e.j41(0,"div",2)(1,"div",3)(2,"label",54),e.EFF(3,"Country *"),e.k0s(),e.j41(4,"div",5),e.nrm(5,"i",52),e.j41(6,"select",55)(7,"option",56),e.EFF(8,"Select a country"),e.k0s(),e.DNE(9,ie,2,2,"option",57),e.k0s()(),e.DNE(10,re,2,0,"div",7),e.k0s(),e.j41(11,"div",3)(12,"label",58),e.EFF(13,"City *"),e.k0s(),e.j41(14,"div",5),e.nrm(15,"i",47),e.j41(16,"select",59)(17,"option",49),e.EFF(18,"Select a city"),e.k0s(),e.DNE(19,oe,2,2,"option",50),e.k0s()(),e.DNE(20,se,2,0,"div",7),e.k0s()()),2&n){const t=e.XpG();let r,i;e.R7$(9),e.Y8G("ngForOf",t.countries),e.R7$(1),e.Y8G("ngIf",(null==(r=t.eventForm.get("country"))?null:r.touched)&&(null==(r=t.eventForm.get("country"))||null==r.errors?null:r.errors.required)),e.R7$(7),e.Y8G("ngValue",null),e.R7$(2),e.Y8G("ngForOf",t.citiesValue),e.R7$(1),e.Y8G("ngIf",(null==(i=t.eventForm.get("city"))?null:i.touched)&&(null==(i=t.eventForm.get("city"))||null==i.errors?null:i.errors.required))}}function le(n,o){1&n&&(e.j41(0,"div",42),e.EFF(1," Price cannot be negative "),e.k0s())}function de(n,o){1&n&&(e.j41(0,"div",42),e.EFF(1," Maximum attendees must be at least 1 "),e.k0s())}function ce(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",61),e.nrm(1,"img",62),e.j41(2,"button",63),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.removeImage())}),e.EFF(3," X "),e.k0s()()}if(2&n){const t=e.XpG();e.R7$(1),e.Y8G("src",t.imagePreviewUrl,e.B4B)}}function ge(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",64),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.triggerImageUpload())}),e.j41(1,"p"),e.EFF(2,"Click to upload image"),e.k0s(),e.j41(3,"p",65),e.EFF(4,"Recommended: 1200x630px, max 5MB"),e.k0s()()}}function ue(n,o){if(1&n&&(e.j41(0,"div",42),e.EFF(1),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.SpI(" ",t.imageError," ")}}let me=(()=>{class n{eventsService;sanitizer;fb;cloudinary;usersService;router;location;eventId;countries=[];citiesValue=[];districtsValue=[];wardsValue=[];eventForm;successMessage="";errorMessage="";eventData;isLoading=!1;imagePreviewUrl=null;imageError=null;selectedFile=null;isOffline=!1;isHybrid=!1;districtsWithCities=[];wardsWithDistricts=[];currentUserId;destroy$=new $.B;geocodingCache=new Map;lastGeocodingRequest=0;GEOCODING_DELAY=1e3;constructor(t,r,i,s,d,g,l){this.eventsService=t,this.sanitizer=r,this.fb=i,this.cloudinary=s,this.usersService=d,this.router=g,this.location=l,k.registerLocale(P),this.initializeForm()}initializeForm(){this.eventForm=this.fb.group({name:["",[a.k0.required,a.k0.minLength(3)]],description:["",[a.k0.required,a.k0.minLength(10)]],content:["",[a.k0.required]],startDate:["",[a.k0.required]],endDate:["",[a.k0.required]],eventType:["offline",[a.k0.required]],details_address:[""],districts:[""],wards:[""],country:[""],city:[""],price:[0,[a.k0.min(0)]],maxAttendees:[1,[a.k0.min(1)]],tags:[""],image:[""]}),this.eventForm.get("eventType")?.valueChanges.pipe((0,b.Q)(this.destroy$)).subscribe(t=>{this.updateEventTypeState(t)}),this.eventForm.get("city")?.valueChanges.pipe((0,b.Q)(this.destroy$),(0,C.B)(300),(0,F.F)()).subscribe(t=>{t&&t.code?(this.districtsWithCities=this.districtsValue.filter(r=>r.parent_code===t.code),this.eventForm.get("districts")?.reset(),this.eventForm.get("wards")?.reset(),this.wardsWithDistricts=[]):(this.districtsWithCities=[],this.wardsWithDistricts=[])}),this.eventForm.get("districts")?.valueChanges.pipe((0,b.Q)(this.destroy$),(0,C.B)(300),(0,F.F)()).subscribe(t=>{t&&t.code?(this.wardsWithDistricts=this.wardsValue.filter(r=>r.parent_code===t.code),this.eventForm.get("wards")?.reset()):this.wardsWithDistricts=[]})}ngOnInit(){this.currentUserId=j.j.currentUser?.uid,this.checkUserAndLoadEvent()}checkUserAndLoadEvent(){this.currentUserId?this.usersService.getCurrentUserById(this.currentUserId).pipe((0,b.Q)(this.destroy$),(0,N.M)(t=>{"organizer"!==t?.type?this.errorMessage="Only organizers can edit events":(this.successMessage=`Welcome Organizer ${t.fullName}`,this.loadEventData())})).subscribe():this.errorMessage="User not authenticated"}loadEventData(){this.eventId?(console.log("Loading event data for ID:",this.eventId),this.eventsService.getEventById(this.eventId).pipe((0,b.Q)(this.destroy$)).subscribe({next:t=>{console.log("Event data loaded:",t),t?(this.eventData=t,this.updateFormWithEventData(t)):this.errorMessage="Event not found"},error:t=>{console.error("Error loading event:",t),this.errorMessage="Error loading event data"}})):console.error("No event ID provided")}updateFormWithEventData(t){if(!t)return void console.error("No event data to update form");console.log("Updating form with event data:",t);const r=new Date(t.date_time_options[0]?.start_time||""),i=new Date(t.date_time_options[0]?.end_time||""),s=r.toISOString().slice(0,16),d=i.toISOString().slice(0,16),g=this.citiesValue.find(m=>m.name===t.location?.city?.name),l=this.districtsValue.find(m=>m.name===t.location?.districts?.name),u=this.wardsValue.find(m=>m.name===t.location?.wards?.name);console.log("Found location data:",{city:g,district:l,ward:u}),g&&(this.districtsWithCities=this.districtsValue.filter(m=>m.parent_code===g.code),console.log("Updated districts for city:",this.districtsWithCities)),l&&(this.wardsWithDistricts=this.wardsValue.filter(m=>m.parent_code===l.code),console.log("Updated wards for district:",this.wardsWithDistricts));const p={name:t.name||"",description:t.description||"",content:t.content||"",startDate:s,endDate:d,eventType:t.event_type||"offline",details_address:t.location?.address||"",districts:l||"",wards:u||"",country:t.location?.country||"",city:g||"",price:t.price||0,maxAttendees:t.max_attendees||1,tags:t.tags?.join(", ")||"",image:t.image_url||""};console.log("Setting form data:",p),this.eventForm.patchValue(p),t.image_url&&(this.imagePreviewUrl=t.image_url),this.updateEventTypeState(t.event_type)}updateEventTypeState(t){this.isOffline="offline"===t,this.isHybrid="hybrid"===t,["details_address","districts","wards","country","city"].forEach(i=>{this.isOffline||this.isHybrid?this.eventForm.get(i)?.setValidators([a.k0.required]):this.eventForm.get(i)?.clearValidators(),this.eventForm.get(i)?.updateValueAndValidity()})}onImageSelected(t){const r=t.target;if(!r.files?.length)return;const i=r.files[0];this.validateImage(i)&&(this.selectedFile=i,this.imageError=null,this.createImagePreview(i))}validateImage(t){return t.type.startsWith("image/")?!(t.size>5242880&&(this.imageError="Image size should not exceed 5MB",1)):(this.imageError="Please select a valid image file",!1)}createImagePreview(t){const r=new FileReader;r.onload=i=>{this.imagePreviewUrl=i.target.result},r.readAsDataURL(t)}removeImage(){this.imagePreviewUrl=null,this.selectedFile=null,this.eventForm.patchValue({image:""})}triggerImageUpload(){document.getElementById("image")?.click()}onSubmit(){var t=this;return(0,_.A)(function*(){if(!t.eventForm.invalid&&!t.isLoading){t.isLoading=!0,t.errorMessage="",t.successMessage="";try{let r=t.eventForm.get("image")?.value;t.selectedFile&&(r=yield t.uploadImage());const i=t.prepareEventData();yield t.updateEvent(i),t.successMessage="Event updated successfully",setTimeout(()=>{t.router.navigate(["/events"])},2e3)}catch(r){t.errorMessage="Error updating event",console.error("Error updating event:",r)}finally{t.isLoading=!1}}})()}uploadImage(){var t=this;return(0,_.A)(function*(){if(!t.selectedFile)throw new Error("No image selected");return new Promise((r,i)=>{t.cloudinary.upLoadImage(t.selectedFile).subscribe({next:s=>r(s.secure_url),error:s=>i(s)})})})()}prepareEventData(){const t=this.eventForm.value,r=t.details_address||"";return{name:t.name,description:t.description,content:t.content,date_time_options:[{start_time:t.startDate,end_time:t.endDate,time_zone:Intl.DateTimeFormat().resolvedOptions().timeZone}],location:{type:t.eventType,address:r,districts:t.districts,wards:t.wards,country:t.country,city:t.city,coordinates:this.eventData?.location?.coordinates||{latitude:0,longitude:0}},image_url:this.imagePreviewUrl||this.eventData?.image_url||"",price:t.price,max_attendees:t.maxAttendees,tags:t.tags.split(",").map(i=>i.trim()).filter(i=>i),event_type:t.eventType,organizer:this.eventData?.organizer||{id:"",name:"",followers:0},status:this.eventData?.status||"published",created_at:this.eventData?.created_at||x.Dc.now(),updated_at:x.Dc.now()}}updateEvent(t){var r=this;return(0,_.A)(function*(){if(!r.eventId)throw new Error("Event ID is required");const i=(0,x.H9)(j.db,"events",r.eventId);yield(0,x.mZ)(i,t)})()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}static \u0275fac=function(r){return new(r||n)(e.rXU(y.H),e.rXU(S.o),e.rXU(a.ok),e.rXU(w.G),e.rXU(I.g),e.rXU(M.Ix),e.rXU(D.s))};static \u0275cmp=e.VBU({type:n,selectors:[["app-edit-event"]],inputs:{eventId:"eventId",countries:"countries",citiesValue:"citiesValue",districtsValue:"districtsValue",wardsValue:"wardsValue"},standalone:!0,features:[e.aNF],decls:89,vars:20,consts:[["class","notification",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"form-row"],[1,"form-group"],["for","name"],[1,"input-with-icon"],["type","text","id","name","formControlName","name","placeholder","Enter event name"],["class","error-message",4,"ngIf"],["for","description"],["id","description","formControlName","description","placeholder","Enter event description"],["for","content"],["id","content","formControlName","content","placeholder","Enter event content"],["for","startDate"],["type","datetime-local","id","startDate","formControlName","startDate"],["for","endDate"],["type","datetime-local","id","endDate","formControlName","endDate"],["for","eventType"],["id","eventType","formControlName","eventType"],["value","offline"],["value","online"],["value","hybrid"],["class","form-group",4,"ngIf"],["class","form-row",4,"ngIf"],["for","price"],["type","number","id","price","formControlName","price","min","0","step","0.01","placeholder","Enter event price"],["for","maxAttendees"],["type","number","id","maxAttendees","formControlName","maxAttendees","min","1","placeholder","Enter maximum attendees"],["for","tags"],["type","text","id","tags","formControlName","tags","placeholder","e.g., Business, Technology"],["for","image"],[1,"image-upload-container"],["class","image-preview",4,"ngIf"],["class","image-upload-area",3,"click",4,"ngIf"],["type","file","id","image","accept","image/*",1,"hidden-input",3,"change"],[1,"form-actions"],["type","button",1,"btn-secondary",3,"click"],["type","submit",1,"btn-primary",3,"disabled"],[1,"notification"],["class","success",4,"ngIf"],["class","error",4,"ngIf"],[1,"success"],[1,"error"],[1,"error-message"],["for","details_address"],[1,"fa-solid","fa-house","input-icon"],["type","text","id","details_address","formControlName","details_address","placeholder","Enter event address"],["for","districts"],[1,"fa-solid","fa-city","input-icon"],["id","districts","formControlName","districts"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],["for","wards"],[1,"fa-solid","fa-earth-asia","input-icon"],["id","wards","formControlName","wards"],["for","country"],["id","country","formControlName","country"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","city"],["id","city","formControlName","city"],[3,"value"],[1,"image-preview"],["alt","Event image preview",3,"src"],["type","button",1,"remove-image",3,"click"],[1,"image-upload-area",3,"click"],[1,"image-hint"]],template:function(r,i){if(1&r&&(e.j41(0,"h3"),e.EFF(1,"Edit Event"),e.k0s(),e.DNE(2,U,3,2,"div",0),e.j41(3,"form",1),e.bIt("ngSubmit",function(){return i.onSubmit()}),e.j41(4,"div",2)(5,"div",3)(6,"label",4),e.EFF(7,"Event Name *"),e.k0s(),e.j41(8,"div",5),e.nrm(9,"input",6),e.k0s(),e.DNE(10,z,2,0,"div",7),e.DNE(11,X,2,0,"div",7),e.k0s()(),e.j41(12,"div",2)(13,"div",3)(14,"label",8),e.EFF(15,"Description *"),e.k0s(),e.j41(16,"div",5),e.nrm(17,"textarea",9),e.k0s(),e.DNE(18,A,2,0,"div",7),e.DNE(19,L,2,0,"div",7),e.k0s()(),e.j41(20,"div",2)(21,"div",3)(22,"label",10),e.EFF(23,"Content *"),e.k0s(),e.j41(24,"div",5),e.nrm(25,"textarea",11),e.k0s(),e.DNE(26,q,2,0,"div",7),e.k0s()(),e.j41(27,"div",2)(28,"div",3)(29,"label",12),e.EFF(30,"Start Date *"),e.k0s(),e.j41(31,"div",5),e.nrm(32,"input",13),e.k0s(),e.DNE(33,B,2,0,"div",7),e.k0s(),e.j41(34,"div",3)(35,"label",14),e.EFF(36,"End Date *"),e.k0s(),e.j41(37,"div",5),e.nrm(38,"input",15),e.k0s(),e.DNE(39,W,2,0,"div",7),e.k0s()(),e.j41(40,"div",2)(41,"div",3)(42,"label",16),e.EFF(43,"Event Type *"),e.k0s(),e.j41(44,"div",5)(45,"select",17)(46,"option",18),e.EFF(47,"Offline"),e.k0s(),e.j41(48,"option",19),e.EFF(49,"Online"),e.k0s(),e.j41(50,"option",20),e.EFF(51,"Hybrid"),e.k0s()()(),e.DNE(52,H,2,0,"div",7),e.k0s()(),e.DNE(53,Q,7,1,"div",21),e.DNE(54,ne,21,6,"div",22),e.DNE(55,ae,21,5,"div",22),e.j41(56,"div",2)(57,"div",3)(58,"label",23),e.EFF(59,"Price"),e.k0s(),e.j41(60,"div",5),e.nrm(61,"input",24),e.k0s(),e.DNE(62,le,2,0,"div",7),e.k0s(),e.j41(63,"div",3)(64,"label",25),e.EFF(65,"Max Attendees"),e.k0s(),e.j41(66,"div",5),e.nrm(67,"input",26),e.k0s(),e.DNE(68,de,2,0,"div",7),e.k0s()(),e.j41(69,"div",2)(70,"div",3)(71,"label",27),e.EFF(72,"Tags (comma separated)"),e.k0s(),e.j41(73,"div",5),e.nrm(74,"input",28),e.k0s()()(),e.j41(75,"div",2)(76,"div",3)(77,"label",29),e.EFF(78,"Event Image"),e.k0s(),e.j41(79,"div",30),e.DNE(80,ce,4,1,"div",31),e.DNE(81,ge,5,0,"div",32),e.j41(82,"input",33),e.bIt("change",function(d){return i.onImageSelected(d)}),e.k0s()(),e.DNE(83,ue,2,1,"div",7),e.k0s()(),e.j41(84,"div",34)(85,"button",35),e.bIt("click",function(){return i.router.navigate(["/events"])}),e.EFF(86," Cancel "),e.k0s(),e.j41(87,"button",36),e.EFF(88),e.k0s()()()),2&r){let s,d,g,l,u,p,m,h,E,v;e.R7$(2),e.Y8G("ngIf",i.successMessage||i.errorMessage),e.R7$(1),e.Y8G("formGroup",i.eventForm),e.R7$(7),e.Y8G("ngIf",(null==(s=i.eventForm.get("name"))?null:s.touched)&&(null==(s=i.eventForm.get("name"))||null==s.errors?null:s.errors.required)),e.R7$(1),e.Y8G("ngIf",(null==(d=i.eventForm.get("name"))?null:d.touched)&&(null==(d=i.eventForm.get("name"))||null==d.errors?null:d.errors.minlength)),e.R7$(7),e.Y8G("ngIf",(null==(g=i.eventForm.get("description"))?null:g.touched)&&(null==(g=i.eventForm.get("description"))||null==g.errors?null:g.errors.required)),e.R7$(1),e.Y8G("ngIf",(null==(l=i.eventForm.get("description"))?null:l.touched)&&(null==(l=i.eventForm.get("description"))||null==l.errors?null:l.errors.minlength)),e.R7$(7),e.Y8G("ngIf",(null==(u=i.eventForm.get("content"))?null:u.touched)&&(null==(u=i.eventForm.get("content"))||null==u.errors?null:u.errors.required)),e.R7$(7),e.Y8G("ngIf",(null==(p=i.eventForm.get("startDate"))?null:p.touched)&&(null==(p=i.eventForm.get("startDate"))||null==p.errors?null:p.errors.required)),e.R7$(6),e.Y8G("ngIf",(null==(m=i.eventForm.get("endDate"))?null:m.touched)&&(null==(m=i.eventForm.get("endDate"))||null==m.errors?null:m.errors.required)),e.R7$(13),e.Y8G("ngIf",(null==(h=i.eventForm.get("eventType"))?null:h.touched)&&(null==(h=i.eventForm.get("eventType"))||null==h.errors?null:h.errors.required)),e.R7$(1),e.Y8G("ngIf",i.isOffline||i.isHybrid),e.R7$(1),e.Y8G("ngIf",i.isOffline||i.isHybrid),e.R7$(1),e.Y8G("ngIf",i.isOffline||i.isHybrid),e.R7$(7),e.Y8G("ngIf",(null==(E=i.eventForm.get("price"))?null:E.touched)&&(null==(E=i.eventForm.get("price"))||null==E.errors?null:E.errors.min)),e.R7$(6),e.Y8G("ngIf",(null==(v=i.eventForm.get("maxAttendees"))?null:v.touched)&&(null==(v=i.eventForm.get("maxAttendees"))||null==v.errors?null:v.errors.min)),e.R7$(12),e.Y8G("ngIf",i.imagePreviewUrl),e.R7$(1),e.Y8G("ngIf",!i.imagePreviewUrl),e.R7$(2),e.Y8G("ngIf",i.imageError),e.R7$(4),e.Y8G("disabled",!i.eventForm.valid||i.isLoading),e.R7$(1),e.SpI(" ",i.isLoading?"Saving...":"Save Changes"," ")}},dependencies:[f.MD,f.Sq,f.bT,a.X1,a.qT,a.xH,a.y7,a.me,a.Q0,a.wz,a.BC,a.cb,a.VZ,a.j4,a.JD,a.YN],styles:[".card[_ngcontent-%COMP%]{background:white;border-radius:12px;padding:25px;box-shadow:0 2px 4px #0000001a;margin-bottom:20px}.form-row[_ngcontent-%COMP%]{display:flex;gap:1.5rem;margin-bottom:1.5rem}.form-group[_ngcontent-%COMP%]{flex:1}label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;color:#333;font-weight:500}.input-with-icon[_ngcontent-%COMP%]{position:relative}input[type=text][_ngcontent-%COMP%], input[type=number][_ngcontent-%COMP%], input[type=datetime-local][_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{width:100%;padding:.75rem;border:1px solid #ddd;border-radius:4px;font-size:1rem;transition:border-color .2s}input[type=text][_ngcontent-%COMP%]:focus, input[type=number][_ngcontent-%COMP%]:focus, input[type=datetime-local][_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus{border-color:#007bff;outline:none}textarea[_ngcontent-%COMP%]{min-height:100px;resize:vertical}.error-message[_ngcontent-%COMP%]{color:#dc3545;font-size:.875rem;margin-top:.25rem}.image-upload-container[_ngcontent-%COMP%]{border:2px dashed #ddd;border-radius:4px;padding:1rem;text-align:center;cursor:pointer;transition:border-color .2s}.image-upload-container[_ngcontent-%COMP%]:hover{border-color:#007bff}.image-preview[_ngcontent-%COMP%]{position:relative;display:inline-block}.image-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:200px;max-height:200px;border-radius:4px}.remove-image[_ngcontent-%COMP%]{position:absolute;top:-10px;right:-10px;background-color:#dc3545;color:#fff;border:none;border-radius:50%;width:24px;height:24px;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:14px}.image-hint[_ngcontent-%COMP%]{color:#6c757d;font-size:.875rem;margin-top:.5rem}.hidden-input[_ngcontent-%COMP%]{display:none}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:1rem;margin-top:2rem}.btn-primary[_ngcontent-%COMP%], .btn-secondary[_ngcontent-%COMP%]{padding:.75rem 1.5rem;border:none;border-radius:4px;font-size:1rem;cursor:pointer;transition:background-color .2s}.btn-primary[_ngcontent-%COMP%]{background-color:#007bff;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#0056b3}.btn-primary[_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed}.btn-secondary[_ngcontent-%COMP%]{background-color:#6c757d;color:#fff}.btn-secondary[_ngcontent-%COMP%]:hover{background-color:#5a6268}.events-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:20px}.event-card[_ngcontent-%COMP%]{border:1px solid #e5e7eb;border-radius:12px;overflow:hidden;transition:transform .2s,box-shadow .2s}.event-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 6px #0000001a}.event-image[_ngcontent-%COMP%]{width:100%;height:200px;overflow:hidden}.event-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.event-header[_ngcontent-%COMP%]{padding:15px;border-bottom:1px solid #e5e7eb}.event-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 10px;color:#1f2937}.event-status[_ngcontent-%COMP%]{display:inline-block;padding:4px 8px;border-radius:4px;font-size:.875rem;font-weight:500}.event-status.upcoming[_ngcontent-%COMP%]{background-color:#dbeafe;color:#1e40af}.event-status.ongoing[_ngcontent-%COMP%]{background-color:#dcfce7;color:#166534}.event-status.past[_ngcontent-%COMP%]{background-color:#f3f4f6;color:#4b5563}.event-details[_ngcontent-%COMP%]{padding:15px}.event-description[_ngcontent-%COMP%]{color:#4b5563;margin-bottom:15px;display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical;overflow:hidden}.event-info[_ngcontent-%COMP%]{display:grid;gap:10px;margin-bottom:15px}.info-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:#6b7280;font-size:.875rem}.info-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#9ca3af}.event-actions[_ngcontent-%COMP%]{display:flex;gap:10px}h3[_ngcontent-%COMP%]{margin-bottom:2rem;color:#333;font-size:1.8rem}.notification[_ngcontent-%COMP%]{margin-bottom:1.5rem}.notification[_ngcontent-%COMP%]   .success[_ngcontent-%COMP%]{background-color:#d4edda;color:#155724;padding:1rem;border-radius:4px;margin-bottom:1rem}.notification[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{background-color:#f8d7da;color:#721c24;padding:1rem;border-radius:4px;margin-bottom:1rem}@media (max-width: 768px){.form-row[_ngcontent-%COMP%]{flex-direction:column;gap:1rem}}"]})}return n})();var T=c(345);function pe(n,o){1&n&&(e.j41(0,"div",5),e.nrm(1,"i",6),e.EFF(2," Loading... "),e.k0s())}function ve(n,o){if(1&n&&(e.j41(0,"div",7),e.EFF(1),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.SpI(" ",t.errorMessage," ")}}function fe(n,o){if(1&n&&e.nrm(0,"img",22),2&n){const t=e.XpG().$implicit,r=e.XpG(2);e.Y8G("src",r.getSafeUrl(t.image_url),e.B4B)("alt",t.name)}}function _e(n,o){1&n&&(e.j41(0,"div",23),e.nrm(1,"i",24),e.k0s())}function he(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",10)(1,"div",11),e.DNE(2,fe,1,2,"img",12),e.DNE(3,_e,2,0,"div",13),e.k0s(),e.j41(4,"div",14)(5,"h3"),e.EFF(6),e.k0s(),e.j41(7,"p",15),e.EFF(8),e.k0s(),e.j41(9,"div",16)(10,"p"),e.nrm(11,"i",17),e.EFF(12),e.k0s(),e.j41(13,"p"),e.nrm(14,"i",18),e.EFF(15),e.k0s()(),e.j41(16,"div",19)(17,"button",20),e.bIt("click",function(){const s=e.eBV(t).$implicit,d=e.XpG(2);return e.Njj(d.restoreEvent(s))}),e.nrm(18,"i",21),e.EFF(19," Restore Event "),e.k0s()()()()}if(2&n){const t=o.$implicit,r=e.XpG(2);e.R7$(2),e.Y8G("ngIf",t.image_url),e.R7$(1),e.Y8G("ngIf",!t.image_url),e.R7$(3),e.JRh(t.name),e.R7$(2),e.JRh(t.description),e.R7$(4),e.SpI(" ",r.formatDate(t.date_time_options[0].start_time),""),e.R7$(3),e.SpI(" ",t.location.address,"")}}function Ee(n,o){if(1&n&&(e.j41(0,"div",8),e.DNE(1,he,20,6,"div",9),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.Y8G("ngForOf",t.cancelledEvents)}}function be(n,o){1&n&&(e.j41(0,"div",25)(1,"p"),e.EFF(2,"No cancelled events found."),e.k0s()())}let Ce=(()=>{class n{eventsService;sanitizer;cancelledEvents=[];isLoading=!1;errorMessage="";restored=new e.bkB;constructor(t,r){this.eventsService=t,this.sanitizer=r}ngOnInit(){this.loadCancelledEvents()}loadCancelledEvents(){this.isLoading=!0,this.eventsService.getEventsByStatus("cancelled").subscribe({next:t=>{this.cancelledEvents=t,this.isLoading=!1},error:t=>{console.error("Error loading cancelled events:",t),this.errorMessage="Failed to load cancelled events",this.isLoading=!1}})}restoreEvent(t){t.id&&this.eventsService.restoreEvent(t.id).subscribe({next:()=>{this.loadCancelledEvents(),this.restored.emit()},error:r=>{console.error("Error restoring event:",r),this.errorMessage="Failed to restore event"}})}getSafeUrl(t){if(t)return this.sanitizer.bypassSecurityTrustUrl(t)}formatDate(t){return new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}static \u0275fac=function(r){return new(r||n)(e.rXU(y.H),e.rXU(T.up))};static \u0275cmp=e.VBU({type:n,selectors:[["app-trash-events"]],outputs:{restored:"restored"},standalone:!0,features:[e.aNF],decls:7,vars:4,consts:[[1,"trash-events-container"],["class","loading-spinner",4,"ngIf"],["class","error-message",4,"ngIf"],["class","events-grid",4,"ngIf"],["class","no-events",4,"ngIf"],[1,"loading-spinner"],[1,"fas","fa-spinner","fa-spin"],[1,"error-message"],[1,"events-grid"],["class","event-card",4,"ngFor","ngForOf"],[1,"event-card"],[1,"event-image"],[3,"src","alt",4,"ngIf"],["class","no-image",4,"ngIf"],[1,"event-details"],[1,"event-description"],[1,"event-info"],[1,"fas","fa-calendar"],[1,"fas","fa-map-marker-alt"],[1,"event-actions"],[1,"btn-restore",3,"click"],[1,"fas","fa-rotate-left"],[3,"src","alt"],[1,"no-image"],[1,"fas","fa-image"],[1,"no-events"]],template:function(r,i){1&r&&(e.j41(0,"div",0)(1,"h2"),e.EFF(2,"Cancelled Events"),e.k0s(),e.DNE(3,pe,3,0,"div",1),e.DNE(4,ve,2,1,"div",2),e.DNE(5,Ee,2,1,"div",3),e.DNE(6,be,3,0,"div",4),e.k0s()),2&r&&(e.R7$(3),e.Y8G("ngIf",i.isLoading),e.R7$(1),e.Y8G("ngIf",i.errorMessage),e.R7$(1),e.Y8G("ngIf",!i.isLoading&&i.cancelledEvents.length>0),e.R7$(1),e.Y8G("ngIf",!i.isLoading&&0===i.cancelledEvents.length))},dependencies:[f.MD,f.Sq,f.bT],styles:['.trash-events-container[_ngcontent-%COMP%]{padding:20px;max-width:1200px;margin:0 auto}.trash-events-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#333;margin-bottom:20px;font-size:24px;font-weight:600;display:flex;align-items:center;gap:10px}.trash-events-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]:before{content:"\\f2ed";font-family:"Font Awesome 6 Free";font-weight:900;color:#dc3545}.loading-spinner[_ngcontent-%COMP%]{text-align:center;padding:40px;color:#666;font-size:18px}.loading-spinner[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:10px;color:#007bff}.error-message[_ngcontent-%COMP%]{color:#dc3545;padding:15px;margin:15px 0;background-color:#f8d7da;border-radius:8px;border-left:4px solid #dc3545;display:flex;align-items:center;gap:10px}.error-message[_ngcontent-%COMP%]:before{content:"\\f071";font-family:"Font Awesome 6 Free";font-weight:900}.events-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:25px;margin-top:25px}.event-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;box-shadow:0 4px 6px #0000001a;overflow:hidden;transition:all .3s ease;border:1px solid #eee}.event-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 8px 15px #0000001a}.event-image[_ngcontent-%COMP%]{height:200px;overflow:hidden;position:relative;background-color:#f8f9fa}.event-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;transition:transform .3s ease}.event-card[_ngcontent-%COMP%]:hover   .event-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{transform:scale(1.05)}.no-image[_ngcontent-%COMP%]{width:100%;height:100%;display:flex;align-items:center;justify-content:center;background-color:#f8f9fa;color:#6c757d;font-size:2.5em}.event-details[_ngcontent-%COMP%]{padding:20px}.event-details[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 12px;color:#333;font-size:1.3em;font-weight:600}.event-description[_ngcontent-%COMP%]{color:#666;font-size:.95em;margin-bottom:15px;line-height:1.5;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}.event-info[_ngcontent-%COMP%]{margin-bottom:20px;padding:15px;background-color:#f8f9fa;border-radius:8px}.event-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:8px 0;color:#555;font-size:.95em;display:flex;align-items:center;gap:8px}.event-info[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#007bff;width:20px;text-align:center}.event-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;padding-top:15px;border-top:1px solid #eee}.btn-restore[_ngcontent-%COMP%]{background-color:#28a745;color:#fff;border:none;padding:10px 20px;border-radius:6px;cursor:pointer;display:flex;align-items:center;gap:8px;font-size:.95em;font-weight:500;transition:all .2s ease}.btn-restore[_ngcontent-%COMP%]:hover{background-color:#218838;transform:translateY(-2px)}.btn-restore[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1em}.no-events[_ngcontent-%COMP%]{text-align:center;padding:50px 20px;color:#666;background-color:#f8f9fa;border-radius:12px;margin-top:30px;font-size:1.1em}.no-events[_ngcontent-%COMP%]:before{content:"\\f2ed";font-family:"Font Awesome 6 Free";font-weight:900;font-size:2em;color:#dc3545;display:block;margin-bottom:15px}@media (max-width: 768px){.events-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.event-card[_ngcontent-%COMP%]{max-width:500px;margin:0 auto}}']})}return n})();var Fe=c(7355);function xe(n,o){if(1&n&&(e.j41(0,"div",19),e.EFF(1),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.SpI(" ",t.errorMessage," ")}}function Me(n,o){if(1&n&&(e.j41(0,"div",20),e.EFF(1),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.SpI(" ",t.successMessage," ")}}function ke(n,o){1&n&&(e.j41(0,"div",56),e.EFF(1," Event name is required "),e.k0s())}function ye(n,o){1&n&&(e.j41(0,"div",56),e.EFF(1," Event name must be at least 3 characters "),e.k0s())}function Oe(n,o){1&n&&(e.j41(0,"div",56),e.EFF(1," Description is required "),e.k0s())}function Pe(n,o){1&n&&(e.j41(0,"div",56),e.EFF(1," Description must be at least 10 characters "),e.k0s())}function je(n,o){1&n&&(e.j41(0,"div",56),e.EFF(1," Start date is required "),e.k0s())}function we(n,o){1&n&&(e.j41(0,"div",56),e.EFF(1," End date is required "),e.k0s())}function Ie(n,o){1&n&&(e.j41(0,"div",56),e.EFF(1," Event type is required "),e.k0s())}function De(n,o){1&n&&(e.j41(0,"span"),e.EFF(1,"Street address is required"),e.k0s())}function Te(n,o){if(1&n&&(e.j41(0,"div",56),e.DNE(1,De,2,0,"span",60),e.k0s()),2&n){const t=e.XpG(3);e.R7$(1),e.Y8G("ngIf",null==t.details_address||null==t.details_address.errors?null:t.details_address.errors.required)}}function Ge(n,o){if(1&n&&(e.j41(0,"div",24)(1,"label",57),e.EFF(2,"Address"),e.k0s(),e.j41(3,"div",26)(4,"span",58),e.EFF(5,"home"),e.k0s(),e.nrm(6,"input",59),e.k0s(),e.DNE(7,Te,2,1,"div",28),e.k0s()),2&n){const t=e.XpG(2);e.R7$(6),e.AVh("is-invalid",(null==t.details_address?null:t.details_address.invalid)&&(null==t.details_address?null:t.details_address.touched)),e.R7$(1),e.Y8G("ngIf",(null==t.details_address?null:t.details_address.invalid)&&(null==t.details_address?null:t.details_address.touched))}}function Re(n,o){if(1&n&&(e.j41(0,"option",63),e.EFF(1),e.k0s()),2&n){const t=o.$implicit;e.Y8G("ngValue",t),e.R7$(1),e.SpI(" ",t.name," ")}}function $e(n,o){1&n&&(e.j41(0,"span"),e.EFF(1,"District is required"),e.k0s())}function Ne(n,o){if(1&n&&(e.j41(0,"div",56),e.DNE(1,$e,2,0,"span",60),e.k0s()),2&n){const t=e.XpG(3);e.R7$(1),e.Y8G("ngIf",null==t.districts||null==t.districts.errors?null:t.districts.errors.required)}}function Se(n,o){if(1&n&&(e.j41(0,"option",63),e.EFF(1),e.k0s()),2&n){const t=o.$implicit;e.Y8G("ngValue",t),e.R7$(1),e.SpI(" ",t.name," ")}}function Ye(n,o){1&n&&(e.j41(0,"span"),e.EFF(1,"Ward is required"),e.k0s())}function Ve(n,o){if(1&n&&(e.j41(0,"div",56),e.DNE(1,Ye,2,0,"span",60),e.k0s()),2&n){const t=e.XpG(3);e.R7$(1),e.Y8G("ngIf",null==t.wards||null==t.wards.errors?null:t.wards.errors.required)}}function Ue(n,o){if(1&n&&(e.j41(0,"div",23)(1,"div",24)(2,"label",61),e.EFF(3,"Districts"),e.k0s(),e.j41(4,"div",26)(5,"span",58),e.EFF(6,"location_city"),e.k0s(),e.j41(7,"select",62)(8,"option",63),e.EFF(9,"Select a district"),e.k0s(),e.DNE(10,Re,2,2,"option",64),e.k0s()(),e.DNE(11,Ne,2,1,"div",28),e.k0s(),e.j41(12,"div",24)(13,"label",65),e.EFF(14,"Wards"),e.k0s(),e.j41(15,"div",26)(16,"span",58),e.EFF(17,"public"),e.k0s(),e.j41(18,"select",66)(19,"option",63),e.EFF(20,"Select a ward"),e.k0s(),e.DNE(21,Se,2,2,"option",64),e.k0s()(),e.DNE(22,Ve,2,1,"div",28),e.k0s()()),2&n){const t=e.XpG(2);e.R7$(7),e.AVh("is-invalid",(null==t.districts?null:t.districts.invalid)&&(null==t.districts?null:t.districts.touched)),e.R7$(1),e.Y8G("ngValue",null),e.R7$(2),e.Y8G("ngForOf",t.districtsWithCities),e.R7$(1),e.Y8G("ngIf",(null==t.districts?null:t.districts.invalid)&&(null==t.districts?null:t.districts.touched)),e.R7$(7),e.AVh("is-invalid",(null==t.wards?null:t.wards.invalid)&&(null==t.wards?null:t.wards.touched)),e.R7$(1),e.Y8G("ngValue",null),e.R7$(2),e.Y8G("ngForOf",t.wardsWithDistricts),e.R7$(1),e.Y8G("ngIf",(null==t.wards?null:t.wards.invalid)&&(null==t.wards?null:t.wards.touched))}}function ze(n,o){if(1&n&&(e.j41(0,"option",73),e.EFF(1),e.k0s()),2&n){const t=o.$implicit;e.Y8G("value",t.name),e.R7$(1),e.SpI(" ",t.name," ")}}function Xe(n,o){1&n&&(e.j41(0,"span"),e.EFF(1,"Country is required"),e.k0s())}function Ae(n,o){if(1&n&&(e.j41(0,"div",56),e.DNE(1,Xe,2,0,"span",60),e.k0s()),2&n){const t=e.XpG(3);e.R7$(1),e.Y8G("ngIf",null==t.country||null==t.country.errors?null:t.country.errors.required)}}function Le(n,o){if(1&n&&(e.j41(0,"option",63),e.EFF(1),e.k0s()),2&n){const t=o.$implicit;e.Y8G("ngValue",t),e.R7$(1),e.SpI(" ",t.name," ")}}function qe(n,o){1&n&&(e.j41(0,"span"),e.EFF(1,"City is required"),e.k0s())}function Be(n,o){if(1&n&&(e.j41(0,"div",56),e.DNE(1,qe,2,0,"span",60),e.k0s()),2&n){const t=e.XpG(3);e.R7$(1),e.Y8G("ngIf",null==t.city||null==t.city.errors?null:t.city.errors.required)}}function We(n,o){if(1&n&&(e.j41(0,"div",23)(1,"div",24)(2,"label",67),e.EFF(3,"Country"),e.k0s(),e.j41(4,"div",26)(5,"span",58),e.EFF(6,"public"),e.k0s(),e.j41(7,"select",68)(8,"option",69),e.EFF(9,"Select a country"),e.k0s(),e.DNE(10,ze,2,2,"option",70),e.k0s()(),e.DNE(11,Ae,2,1,"div",28),e.k0s(),e.j41(12,"div",24)(13,"label",71),e.EFF(14,"City"),e.k0s(),e.j41(15,"div",26)(16,"span",58),e.EFF(17,"location_city"),e.k0s(),e.j41(18,"select",72)(19,"option",63),e.EFF(20,"Select a city"),e.k0s(),e.DNE(21,Le,2,2,"option",64),e.k0s()(),e.DNE(22,Be,2,1,"div",28),e.k0s()()),2&n){const t=e.XpG(2);e.R7$(7),e.AVh("is-invalid",(null==t.country?null:t.country.invalid)&&(null==t.country?null:t.country.touched)),e.R7$(3),e.Y8G("ngForOf",t.countries),e.R7$(1),e.Y8G("ngIf",(null==t.country?null:t.country.invalid)&&(null==t.country?null:t.country.touched)),e.R7$(7),e.AVh("is-invalid",(null==t.city?null:t.city.invalid)&&(null==t.city?null:t.city.touched)),e.R7$(1),e.Y8G("ngValue",null),e.R7$(2),e.Y8G("ngForOf",t.citiesValue),e.R7$(1),e.Y8G("ngIf",(null==t.city?null:t.city.invalid)&&(null==t.city?null:t.city.touched))}}function He(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",74),e.nrm(1,"img",75),e.j41(2,"button",76),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.removeImage())}),e.EFF(3," X "),e.k0s()()}if(2&n){const t=e.XpG(2);e.R7$(1),e.Y8G("src",t.imagePreviewUrl,e.B4B)}}function Je(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",77),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.triggerImageUpload())}),e.j41(1,"p"),e.EFF(2,"Click to upload image"),e.k0s(),e.j41(3,"p",78),e.EFF(4,"Recommended: 1200x630px, max 5MB"),e.k0s()()}}function Qe(n,o){if(1&n&&(e.j41(0,"div",56),e.EFF(1),e.k0s()),2&n){const t=e.XpG(2);e.R7$(1),e.SpI(" ",t.imageError," ")}}function Ze(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",21)(1,"h3"),e.EFF(2,"Create New Event"),e.k0s(),e.j41(3,"form",22),e.bIt("ngSubmit",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.onSubmit())}),e.j41(4,"div",23)(5,"div",24)(6,"label",25),e.EFF(7,"Event Name *"),e.k0s(),e.j41(8,"div",26),e.nrm(9,"input",27),e.k0s(),e.DNE(10,ke,2,0,"div",28),e.DNE(11,ye,2,0,"div",28),e.k0s()(),e.j41(12,"div",23)(13,"div",24)(14,"label",29),e.EFF(15,"Description *"),e.k0s(),e.j41(16,"div",26),e.nrm(17,"textarea",30),e.k0s(),e.DNE(18,Oe,2,0,"div",28),e.DNE(19,Pe,2,0,"div",28),e.k0s()(),e.j41(20,"div",23)(21,"div",24)(22,"label",31),e.EFF(23,"Start Date *"),e.k0s(),e.j41(24,"div",26),e.nrm(25,"input",32),e.k0s(),e.DNE(26,je,2,0,"div",28),e.k0s(),e.j41(27,"div",24)(28,"label",33),e.EFF(29,"End Date *"),e.k0s(),e.j41(30,"div",26),e.nrm(31,"input",34),e.k0s(),e.DNE(32,we,2,0,"div",28),e.k0s()(),e.j41(33,"div",23)(34,"div",24)(35,"label",35),e.EFF(36,"Event Type *"),e.k0s(),e.j41(37,"div",26)(38,"select",36)(39,"option",37),e.EFF(40,"Offline"),e.k0s(),e.j41(41,"option",38),e.EFF(42,"Online"),e.k0s(),e.j41(43,"option",39),e.EFF(44,"Hybrid"),e.k0s()()(),e.DNE(45,Ie,2,0,"div",28),e.k0s()(),e.DNE(46,Ge,8,3,"div",40),e.DNE(47,Ue,23,10,"div",41),e.DNE(48,We,23,9,"div",41),e.j41(49,"div",23)(50,"div",24)(51,"label",42),e.EFF(52,"Price"),e.k0s(),e.j41(53,"div",26),e.nrm(54,"input",43),e.k0s()(),e.j41(55,"div",24)(56,"label",44),e.EFF(57,"Max Attendees"),e.k0s(),e.j41(58,"div",26),e.nrm(59,"input",45),e.k0s()()(),e.j41(60,"div",23)(61,"div",24)(62,"label",46),e.EFF(63,"Tags (comma separated)"),e.k0s(),e.j41(64,"div",26),e.nrm(65,"input",47),e.k0s()(),e.j41(66,"div",24)(67,"label",48),e.EFF(68,"Event Image"),e.k0s(),e.j41(69,"div",49),e.DNE(70,He,4,1,"div",50),e.DNE(71,Je,5,0,"div",51),e.j41(72,"input",52),e.bIt("change",function(i){e.eBV(t);const s=e.XpG();return e.Njj(s.onImageSelected(i))}),e.k0s()(),e.DNE(73,Qe,2,1,"div",28),e.k0s()(),e.nrm(74,"div",23),e.j41(75,"div",53)(76,"button",54),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.toggleCreateEventForm())}),e.EFF(77," Cancel "),e.k0s(),e.j41(78,"button",55),e.EFF(79),e.k0s()()()()}if(2&n){const t=e.XpG();let r,i,s,d,g,l,u;e.R7$(3),e.Y8G("formGroup",t.eventForm),e.R7$(7),e.Y8G("ngIf",(null==(r=t.eventForm.get("name"))?null:r.touched)&&(null==(r=t.eventForm.get("name"))||null==r.errors?null:r.errors.required)),e.R7$(1),e.Y8G("ngIf",(null==(i=t.eventForm.get("name"))?null:i.touched)&&(null==(i=t.eventForm.get("name"))||null==i.errors?null:i.errors.minlength)),e.R7$(7),e.Y8G("ngIf",(null==(s=t.eventForm.get("description"))?null:s.touched)&&(null==(s=t.eventForm.get("description"))||null==s.errors?null:s.errors.required)),e.R7$(1),e.Y8G("ngIf",(null==(d=t.eventForm.get("description"))?null:d.touched)&&(null==(d=t.eventForm.get("description"))||null==d.errors?null:d.errors.minlength)),e.R7$(7),e.Y8G("ngIf",(null==(g=t.eventForm.get("startDate"))?null:g.touched)&&(null==(g=t.eventForm.get("startDate"))||null==g.errors?null:g.errors.required)),e.R7$(6),e.Y8G("ngIf",(null==(l=t.eventForm.get("endDate"))?null:l.touched)&&(null==(l=t.eventForm.get("endDate"))||null==l.errors?null:l.errors.required)),e.R7$(13),e.Y8G("ngIf",(null==(u=t.eventForm.get("eventType"))?null:u.touched)&&(null==(u=t.eventForm.get("eventType"))||null==u.errors?null:u.errors.required)),e.R7$(1),e.Y8G("ngIf",t.isOffline||t.isHybird),e.R7$(1),e.Y8G("ngIf",t.isOffline||t.isHybird),e.R7$(1),e.Y8G("ngIf",t.isOffline||t.isHybird),e.R7$(22),e.Y8G("ngIf",t.imagePreviewUrl),e.R7$(1),e.Y8G("ngIf",!t.imagePreviewUrl),e.R7$(2),e.Y8G("ngIf",t.imageError),e.R7$(5),e.Y8G("disabled",!t.eventForm.valid||t.isLoading),e.R7$(1),e.SpI(" ",t.isLoading?"Creating...":"Create Event"," ")}}function Ke(n,o){1&n&&(e.j41(0,"div",83),e.EFF(1," Loading events... "),e.k0s())}function et(n,o){if(1&n&&(e.j41(0,"div",100),e.nrm(1,"img",101),e.k0s()),2&n){const t=e.XpG().$implicit;e.R7$(1),e.Y8G("src",t.image_url,e.B4B)}}function tt(n,o){if(1&n&&(e.j41(0,"div",93)(1,"span",94),e.EFF(2,"sell"),e.k0s(),e.j41(3,"span"),e.EFF(4),e.k0s()()),2&n){const t=e.XpG().$implicit;e.R7$(4),e.SpI("Price: $",t.price,"")}}function nt(n,o){if(1&n){const t=e.RV6();e.j41(0,"button",102),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,s=e.XpG(3);return e.Njj(s.editEvent(i))}),e.j41(1,"span",94),e.EFF(2,"edit"),e.k0s(),e.EFF(3," Edit "),e.k0s()}}function it(n,o){if(1&n){const t=e.RV6();e.j41(0,"button",103),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,s=e.XpG(3);return e.Njj(s.confirmDelete(i))}),e.j41(1,"span",94),e.EFF(2,"delete"),e.k0s(),e.EFF(3," Delete "),e.k0s()}}function rt(n,o){if(1&n){const t=e.RV6();e.j41(0,"button",104),e.bIt("click",function(){e.eBV(t);const i=e.XpG().$implicit,s=e.XpG(3);return e.Njj(s.restoreEvent(i))}),e.j41(1,"span",94),e.EFF(2,"restore"),e.k0s(),e.EFF(3," Restore "),e.k0s()}}function ot(n,o){if(1&n&&(e.j41(0,"div",86),e.DNE(1,et,2,1,"div",87),e.j41(2,"div",88)(3,"h3"),e.EFF(4),e.k0s(),e.j41(5,"span",89),e.EFF(6),e.k0s()(),e.j41(7,"div",90)(8,"p",91),e.EFF(9),e.k0s(),e.j41(10,"div",92)(11,"div",93)(12,"span",94),e.EFF(13,"schedule"),e.k0s(),e.j41(14,"span"),e.EFF(15),e.k0s()(),e.j41(16,"div",93)(17,"span",94),e.EFF(18,"location_on"),e.k0s(),e.j41(19,"span"),e.EFF(20),e.k0s()(),e.j41(21,"div",93)(22,"span",94),e.EFF(23,"groups"),e.k0s(),e.j41(24,"span"),e.EFF(25),e.k0s()(),e.DNE(26,tt,5,1,"div",95),e.k0s(),e.j41(27,"div",96),e.DNE(28,nt,4,0,"button",97),e.DNE(29,it,4,0,"button",98),e.DNE(30,rt,4,0,"button",99),e.k0s()()()),2&n){const t=o.$implicit,r=e.XpG(3);e.R7$(1),e.Y8G("ngIf",t.image_url),e.R7$(3),e.JRh(t.name),e.R7$(1),e.HbH(r.getEventStatus(t).toLowerCase()),e.R7$(1),e.SpI(" ",r.getEventStatus(t)," "),e.R7$(3),e.JRh(t.description),e.R7$(6),e.SpI("Start: ",r.formatDate(t.date_time_options[0].start_time),""),e.R7$(5),e.JRh("online"===t.location.type?"Online Event":t.location.address),e.R7$(5),e.Lme("",t.attendees_count||0," / ",t.max_attendees||"Unlimited"," attendees"),e.R7$(1),e.Y8G("ngIf",t.price),e.R7$(2),e.Y8G("ngIf","Past"!==r.getEventStatus(t)),e.R7$(1),e.Y8G("ngIf","Cancelled"!==r.getEventStatus(t)),e.R7$(1),e.Y8G("ngIf","Cancelled"===r.getEventStatus(t))}}function st(n,o){if(1&n&&(e.j41(0,"div",84),e.DNE(1,ot,31,14,"div",85),e.k0s()),2&n){const t=e.XpG(2);e.R7$(1),e.Y8G("ngForOf",t.getFilteredEvents())}}function at(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",105)(1,"p"),e.EFF(2),e.k0s(),e.j41(3,"button",106),e.bIt("click",function(){e.eBV(t);const i=e.XpG(2);return e.Njj(i.toggleCreateEventForm())}),e.EFF(4," Create Your First Event "),e.k0s()()}if(2&n){const t=e.XpG(2);e.R7$(2),e.SpI("No ",t.activeTab," events found.")}}function lt(n,o){if(1&n&&(e.j41(0,"div",79),e.DNE(1,Ke,2,0,"div",80),e.DNE(2,st,2,1,"div",81),e.DNE(3,at,5,1,"div",82),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.Y8G("ngIf",t.isLoading),e.R7$(1),e.Y8G("ngIf",!t.isLoading),e.R7$(1),e.Y8G("ngIf",!t.isLoading&&0===t.getFilteredEvents().length)}}function dt(n,o){if(1&n&&(e.j41(0,"div",107),e.nrm(1,"app-edit-event",108),e.k0s()),2&n){const t=e.XpG();e.R7$(1),e.Y8G("eventId",t.editEventid)("countries",t.countries)("citiesValue",t.citiesValue)("districtsValue",t.districtsValue)("wardsValue",t.wardsValue)}}function ct(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",107)(1,"app-trash-events",109),e.bIt("restored",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.loadOrganizerEvents())}),e.k0s()()}}function gt(n,o){if(1&n){const t=e.RV6();e.j41(0,"div",110)(1,"div",111)(2,"h3",112),e.EFF(3,"Cancel Event"),e.k0s(),e.j41(4,"p",113),e.EFF(5,"Are you sure you want to cancel this event? This action can be undone later."),e.k0s(),e.j41(6,"div",114)(7,"button",115),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.cancelDelete())}),e.EFF(8,"Cancel"),e.k0s(),e.j41(9,"button",116),e.bIt("click",function(){e.eBV(t);const i=e.XpG();return e.Njj(i.deleteEvent(i.eventToDelete))}),e.EFF(10,"Confirm"),e.k0s()()()()}}let ut=(()=>{class n{usersService;router;sanitizer;eventService;cloudinaryService;fb;location;authService;editEventid;currentUser;currentOrganizerEvent=[];errorMessage="";successMessage="";showCreateEventForm=!1;eventForm;activeTab="upcoming";isLoading=!1;selectedImage=null;imageError="";imagePreviewUrl=null;trashEvents=[];EditEvents=[];countries=[];citiesValue=[];districtsValue=[];wardsValue=[];districtsWithCities=[];wardsWithDistricts=[];isOffline=!1;isHybird=!1;geocodingCache=new Map;lastGeocodingRequest=0;GEOCODING_DELAY=1e3;showDeleteDialog=!1;eventToDelete=null;constructor(t,r,i,s,d,g,l,u){this.usersService=t,this.router=r,this.sanitizer=i,this.eventService=s,this.cloudinaryService=d,this.fb=g,this.location=l,this.authService=u,this.eventForm=this.fb.group({name:["",[a.k0.required,a.k0.minLength(3)]],description:["",[a.k0.required,a.k0.minLength(10)]],startDate:["",a.k0.required],endDate:["",a.k0.required],details_address:["",a.k0.required],wards:["",[a.k0.required]],districts:["",[a.k0.required]],country:["",[a.k0.required]],city:["",[a.k0.required]],price:[0],maxAttendees:[100],tags:[""],eventType:["offline",a.k0.required]}),k.registerLocale(P)}get details_address(){return this.eventForm.get("details_address")}get wards(){return this.eventForm.get("wards")}get districts(){return this.eventForm.get("districts")}get country(){return this.eventForm.get("country")}get city(){return this.eventForm.get("city")}ngOnInit(){this.location.getCities().subscribe(r=>{this.citiesValue=r}),this.location.getDistricts().subscribe(r=>{this.districtsValue=r}),this.location.getWards().subscribe(r=>{this.wardsValue=r}),this.eventForm.get("city")?.valueChanges.pipe((0,C.B)(300),(0,F.F)()).subscribe(r=>{r&&r.code?(this.districtsWithCities=this.districtsValue.filter(i=>i.parent_code===r.code),this.eventForm.get("districts")?.reset(),this.eventForm.get("wards")?.reset(),this.wardsWithDistricts=[],this.errorMessage="Please select a district"):(this.districtsWithCities=[],this.wardsWithDistricts=[],this.errorMessage="Please select a city")}),this.eventForm.get("districts")?.valueChanges.pipe((0,C.B)(300),(0,F.F)()).subscribe(r=>{r&&r.code?(this.wardsWithDistricts=this.wardsValue.filter(i=>i.parent_code===r.code),this.eventForm.get("wards")?.reset(),this.errorMessage="Please select a ward"):(this.wardsWithDistricts=[],this.errorMessage="Please select a district")}),this.eventForm.get("eventType")?.valueChanges.subscribe(r=>{this.isOffline="offline"===r,this.isHybird="hybrid"===r});const t=this.eventForm.get("eventType")?.value;this.isOffline="offline"===t,this.isHybird="hybrid"===t,this.loadUserData(),this.countries=this.getCountryList()}loadUserData(){(0,G.xI)().onAuthStateChanged(r=>{r?this.usersService.getCurrentUserById(r.uid).subscribe(i=>{i?(this.currentUser=i,this.loadOrganizerEvents()):(this.errorMessage="User data not found",this.router.navigate(["/home"]))}):this.router.navigate(["/login"])})}loadOrganizerEvents(){this.currentUser?.id&&(this.isLoading=!0,(0,R.H)(this.eventService.getEventsByOrganizer(String(this.currentUser.id))).subscribe({next:t=>{this.currentOrganizerEvent=t,this.isLoading=!1},error:t=>{console.error("Error loading events:",t),this.errorMessage="Failed to load events",this.isLoading=!1}}))}toggleCreateEventForm(){this.showCreateEventForm=!this.showCreateEventForm,this.showCreateEventForm||(this.eventForm.reset(),this.selectedImage=null,this.imagePreviewUrl=null,this.imageError="",this.errorMessage="",this.successMessage="")}onImageSelected(t){const r=t.target;if(r.files&&r.files[0]){const i=r.files[0];if(i.size>5242880)return void(this.imageError="Image size should be less than 5MB");if(!i.type.match(/image\/(jpeg|png|gif|jpg)/))return void(this.imageError="Only JPG, PNG and GIF images are allowed");const s=new Image;s.src=URL.createObjectURL(i),s.onload=()=>{s.width<800||s.height<600?this.imageError="Image dimensions should be at least 800x600 pixels":(this.selectedImage=i,this.imageError="",this.imagePreviewUrl=URL.createObjectURL(i))}}}removeImage(){this.selectedImage=null,this.imagePreviewUrl=null,this.imageError="";const t=document.getElementById("image");t&&(t.value="")}triggerImageUpload(){const t=document.getElementById("image");t&&t.click()}uploadImage(){var t=this;return(0,_.A)(function*(){if(!t.selectedImage)return null;try{return new Promise((r,i)=>{t.cloudinaryService.upLoadImage(t.selectedImage).subscribe({next:s=>{r(s.secure_url)},error:s=>{console.error("Error uploading image:",s),t.imageError="Failed to upload image. Please try again.",i(s)}})})}catch(r){return console.error("Error uploading image:",r),t.imageError="Failed to upload image. Please try again.",null}})()}getCountryList(){try{const t=k.getNames("en",{select:"official"})||{};return Object.entries(t).map(([r,i])=>({code:r,name:i}))}catch(t){return console.error("Error getting country list:",t),[]}}onSubmit(){var t=this;return(0,_.A)(function*(){if(t.eventForm.valid){t.isLoading=!0;const r=t.eventForm.value;let i=null;if(t.selectedImage&&(i=yield t.uploadImage(),!i))return void(t.isLoading=!1);const s=t.getTrimmedString((t.eventForm.get("wards")?.value).name),d=t.getTrimmedString((t.eventForm.get("districts")?.value).name),g=t.getTrimmedString((t.eventForm.get("city")?.value).name),l=t.eventForm.get("country")?.value,u=`${r.details_address}, ${s} ,${d}, ${g}, ${l}`,p=yield t.getLanLongFromAddress(u);if(!p)return t.isLoading=!1,void(t.errorMessage="Kh\xf4ng t\xecm th\u1ea5y v\u1ecb tr\xed t\u1eeb \u0111\u1ecba ch\u1ec9.");const m=p.lat,h=p.lon,E={name:r.name,description:r.description,content:r.description,date_time_options:[{start_time:r.startDate,end_time:r.endDate,time_zone:Intl.DateTimeFormat().resolvedOptions().timeZone}],location:{type:r.eventType,address:u,coordinates:{latitude:m,longitude:h}},image_url:i||"https://res.cloudinary.com/dpiqldk0y/image/upload/v1743794493/samples/coffee.jpg",price:r.price,max_attendees:r.maxAttendees,tags:r.tags.split(",").map(v=>v.trim()).filter(v=>v),event_type:r.eventType,organizer:{id:String(t.currentUser?.id||"0"),name:t.currentUser?.fullName||"",followers:0,profileImage:t.currentUser?.profileImage||"https://res.cloudinary.com/dpiqldk0y/image/upload/v1744575077/default-avatar_br3ffh.png"}};t.eventService.addEvent(E).subscribe({next:()=>{t.successMessage="Event created successfully",t.showCreateEventForm=!1,t.eventForm.reset(),t.selectedImage=null,t.imagePreviewUrl=null,t.loadOrganizerEvents(),t.isLoading=!1},error:v=>{console.error("Error creating event:",v),t.errorMessage="Failed to create event",t.isLoading=!1}})}else t.errorMessage="Please fill in all required fields correctly",Object.keys(t.eventForm.controls).forEach(r=>{const i=t.eventForm.get(r);i&&i.markAsTouched()})})()}setActiveTab(t){this.activeTab=t,this.showCreateEventForm&&this.toggleCreateEventForm()}sanitizeImageUrl(t){if(t&&""!==t.trim())return this.sanitizer.bypassSecurityTrustUrl(t)}getComingUpEvents(t){const r=new Date;return t.date_time_options.some(i=>{const s=new Date(i.start_time),d=new Date(i.end_time);return s>r||d>r})}getTotalRevenue(t){return t.price&&t.attendees_count?t.price*t.attendees_count:0}formatDate(t){return new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}getEventStatus(t){if("cancelled"===t.status)return"Cancelled";const r=new Date,i=new Date(t.date_time_options[0].start_time),s=new Date(t.date_time_options[0].end_time);return i>r?"Upcoming":s<r?"Past":"Ongoing"}editEvent(t){this.editEventid=t.id,this.activeTab="edit"}confirmDelete(t){this.eventToDelete=t,this.showDeleteDialog=!0}cancelDelete(){this.showDeleteDialog=!1,this.eventToDelete=null}deleteEvent(t){var r=this;return(0,_.A)(function*(){if(t.id)try{yield r.eventService.cancelEvent(t.id).toPromise(),r.successMessage="Event cancelled successfully",r.showDeleteDialog=!1,r.eventToDelete=null,r.loadOrganizerEvents()}catch(i){console.error("Error cancelling event:",i),r.errorMessage="Failed to cancel event"}})()}restoreEvent(t){var r=this;return(0,_.A)(function*(){if(t.id)try{yield r.eventService.restoreEvent(t.id).toPromise(),r.successMessage="Event restored successfully",r.loadOrganizerEvents()}catch(i){console.error("Error restoring event:",i),r.errorMessage="Failed to restore event"}})()}getFilteredEvents(){if(!this.currentOrganizerEvent.length)return[];const t=new Date;return this.currentOrganizerEvent.filter("upcoming"===this.activeTab?r=>new Date(r.date_time_options[0].start_time)>t&&"cancelled"!==r.status:"past"===this.activeTab?r=>new Date(r.date_time_options[0].end_time)<t&&"cancelled"!==r.status:r=>"cancelled"!==r.status)}getTrimmedString(t){return"string"==typeof t?t.trim():""}getLanLongFromAddress(t){var r=this;return(0,_.A)(function*(){if(r.geocodingCache.has(t))return r.geocodingCache.get(t)||null;const s=Date.now()-r.lastGeocodingRequest;s<r.GEOCODING_DELAY&&(yield new Promise(l=>setTimeout(l,r.GEOCODING_DELAY-s)));const g=`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(t)}`;try{const u=yield(yield fetch(g)).json();if(r.lastGeocodingRequest=Date.now(),u&&u.length>0){const p={lat:parseFloat(u[0].lat),lon:parseFloat(u[0].lon)};return r.geocodingCache.set(t,p),p}return console.warn("Address not found:",t),null}catch(l){return console.error("Geocoding error:",l),null}})()}getEventIdEdit(t){return this.editEventid=t}onEventRestored(){this.setActiveTab("past"),this.loadOrganizerEvents()}static \u0275fac=function(r){return new(r||n)(e.rXU(I.g),e.rXU(M.Ix),e.rXU(T.up),e.rXU(y.H),e.rXU(w.G),e.rXU(a.ok),e.rXU(D.s),e.rXU(Fe.u))};static \u0275cmp=e.VBU({type:n,selectors:[["app-manage-events"]],standalone:!0,features:[e.aNF],decls:37,vars:17,consts:[[1,"brower-event-container"],[1,"container"],[1,"sidebar"],[1,"logo"],[1,"user-info"],["alt","User Avatar",1,"avatar",3,"src"],[1,"username"],[1,"role"],[1,"menu"],[3,"click"],[1,"main-content"],[1,"header"],[1,"create-event-btn",3,"click"],["class","alert alert-error",4,"ngIf"],["class","alert alert-success",4,"ngIf"],["class","card create-event-form",4,"ngIf"],["class","card events-list",4,"ngIf"],["class","card",4,"ngIf"],["class","delete-dialog",4,"ngIf"],[1,"alert","alert-error"],[1,"alert","alert-success"],[1,"card","create-event-form"],[3,"formGroup","ngSubmit"],[1,"form-row"],[1,"form-group"],["for","name"],[1,"input-with-icon"],["type","text","id","name","formControlName","name","placeholder","Enter event name"],["class","error-message",4,"ngIf"],["for","description"],["id","description","formControlName","description","placeholder","Enter event description"],["for","startDate"],["type","datetime-local","id","startDate","formControlName","startDate"],["for","endDate"],["type","datetime-local","id","endDate","formControlName","endDate"],["for","eventType"],["id","eventType","formControlName","eventType"],["value","offline"],["value","online"],["value","hybrid"],["class","form-group",4,"ngIf"],["class","form-row",4,"ngIf"],["for","price"],["type","number","id","price","formControlName","price","min","0","step","0.01"],["for","maxAttendees"],["type","number","id","maxAttendees","formControlName","maxAttendees","min","1"],["for","tags"],["type","text","id","tags","formControlName","tags","placeholder","e.g., Business, Technology"],["for","image"],[1,"image-upload-container"],["class","image-preview",4,"ngIf"],["class","image-upload-area",3,"click",4,"ngIf"],["type","file","id","image","accept","image/*",1,"hidden-input",3,"change"],[1,"form-actions"],["type","button",1,"btn-secondary",3,"click"],["type","submit",1,"btn-primary",3,"disabled"],[1,"error-message"],["for","details_address"],[1,"material-icons","input-icon"],["type","text","id","details_address","formControlName","details_address","placeholder","Enter your details_address address"],[4,"ngIf"],["for","districts"],["id","districts","formControlName","districts"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],["for","wards"],["id","wards","formControlName","wards"],["for","country"],["id","country","formControlName","country"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","city"],["id","city","formControlName","city"],[3,"value"],[1,"image-preview"],["alt","Event image preview",3,"src"],["type","button",1,"remove-image",3,"click"],[1,"image-upload-area",3,"click"],[1,"image-hint"],[1,"card","events-list"],["class","loading-spinner",4,"ngIf"],["class","events-grid",4,"ngIf"],["class","no-events",4,"ngIf"],[1,"loading-spinner"],[1,"events-grid"],["class","event-card",4,"ngFor","ngForOf"],[1,"event-card"],["class","event-image",4,"ngIf"],[1,"event-header"],[1,"event-status"],[1,"event-details"],[1,"event-description"],[1,"event-info"],[1,"info-item"],[1,"material-icons"],["class","info-item",4,"ngIf"],[1,"event-actions"],["class","btn-edit",3,"click",4,"ngIf"],["class","btn-delete",3,"click",4,"ngIf"],["class","btn-restore",3,"click",4,"ngIf"],[1,"event-image"],["alt","Event image",3,"src"],[1,"btn-edit",3,"click"],[1,"btn-delete",3,"click"],[1,"btn-restore",3,"click"],[1,"no-events"],[1,"btn-primary",3,"click"],[1,"card"],[3,"eventId","countries","citiesValue","districtsValue","wardsValue"],[3,"restored"],[1,"delete-dialog"],[1,"delete-dialog-content"],[1,"delete-dialog-title"],[1,"delete-dialog-message"],[1,"delete-dialog-actions"],[1,"delete-dialog-btn","cancel",3,"click"],[1,"delete-dialog-btn","confirm",3,"click"]],template:function(r,i){1&r&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"span"),e.EFF(5,"Event Management"),e.k0s()(),e.j41(6,"div",4),e.nrm(7,"img",5),e.j41(8,"div")(9,"h4",6),e.EFF(10),e.k0s(),e.j41(11,"p",7),e.EFF(12),e.k0s()()(),e.j41(13,"div",8)(14,"ul")(15,"li",9),e.bIt("click",function(){return i.setActiveTab("upcoming")}),e.j41(16,"span"),e.EFF(17,"Upcoming Events"),e.k0s()(),e.j41(18,"li",9),e.bIt("click",function(){return i.setActiveTab("past")}),e.j41(19,"span"),e.EFF(20,"Past Events"),e.k0s()(),e.j41(21,"li",9),e.bIt("click",function(){return i.setActiveTab("delete")}),e.j41(22,"span"),e.EFF(23,"Cancelled Events"),e.k0s()()()()(),e.j41(24,"div",10)(25,"div",11)(26,"h2"),e.EFF(27),e.k0s(),e.j41(28,"button",12),e.bIt("click",function(){return i.toggleCreateEventForm()}),e.EFF(29," Create New Event "),e.k0s()(),e.DNE(30,xe,2,1,"div",13),e.DNE(31,Me,2,1,"div",14),e.DNE(32,Ze,80,16,"div",15),e.DNE(33,lt,4,3,"div",16),e.DNE(34,dt,2,5,"div",17),e.DNE(35,ct,2,0,"div",17),e.DNE(36,gt,11,0,"div",18),e.k0s()()()),2&r&&(e.R7$(7),e.Y8G("src",i.sanitizeImageUrl(null==i.currentUser?null:i.currentUser.profileImage),e.B4B),e.R7$(3),e.JRh(null==i.currentUser?null:i.currentUser.fullName),e.R7$(2),e.JRh(null==i.currentUser?null:i.currentUser.role),e.R7$(3),e.AVh("active","upcoming"===i.activeTab),e.R7$(3),e.AVh("active","past"===i.activeTab),e.R7$(3),e.AVh("active","delete"===i.activeTab),e.R7$(6),e.SpI(" ","upcoming"===i.activeTab?"Upcoming Events":"Past Events"," "),e.R7$(3),e.Y8G("ngIf",i.errorMessage),e.R7$(1),e.Y8G("ngIf",i.successMessage),e.R7$(1),e.Y8G("ngIf",i.showCreateEventForm),e.R7$(1),e.Y8G("ngIf",!i.showCreateEventForm&&("past"===i.activeTab||"upcoming"===i.activeTab)),e.R7$(1),e.Y8G("ngIf",!i.showCreateEventForm&&"edit"===i.activeTab),e.R7$(1),e.Y8G("ngIf",!i.showCreateEventForm&&"delete"===i.activeTab),e.R7$(1),e.Y8G("ngIf",i.showDeleteDialog))},dependencies:[M.iI,f.MD,f.Sq,f.bT,a.YN,a.qT,a.xH,a.y7,a.me,a.Q0,a.wz,a.BC,a.cb,a.VZ,a.X1,a.j4,a.JD,Ce,me],styles:['*[_ngcontent-%COMP%]{margin:0;padding:0;box-sizing:border-box;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif}.brower-event-container[_ngcontent-%COMP%]{min-height:100vh;background-color:#f8f9fa}.container[_ngcontent-%COMP%]{max-width:1400px;margin:0 auto;padding:20px;display:flex;gap:30px}.sidebar[_ngcontent-%COMP%]{width:280px;background:white;border-radius:12px;padding:20px;box-shadow:0 2px 4px #0000001a;height:-moz-fit-content;height:fit-content;position:sticky;top:20px}.logo[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;font-size:1.2rem;font-weight:600;color:#2563eb;margin-bottom:20px}.logo[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.4rem}.user-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:15px;padding:15px 0;border-bottom:1px solid #e5e7eb;margin-bottom:20px}.avatar[_ngcontent-%COMP%]{width:50px;height:50px;border-radius:50%;object-fit:cover}.username[_ngcontent-%COMP%]{font-size:1rem;font-weight:600;margin:0}.role[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280;margin:0}.input-icon[_ngcontent-%COMP%]{position:absolute;left:12px;color:#000;font-size:16px;font-family:"Font Awesome 6 Free"}input[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{width:100%;padding:12px 15px 12px 40px;border:1px solid #ced4da;border-radius:8px;font-size:14px;transition:all .3s ease;background-color:#fff}.menu[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.menu[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:12px 15px;border-radius:8px;cursor:pointer;transition:all .2s;color:#4b5563}.menu[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:hover{background-color:#f3f4f6;color:#2563eb}.menu[_ngcontent-%COMP%]   li.active[_ngcontent-%COMP%]{background-color:#2563eb;color:#fff}.menu[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.1rem}.main-content[_ngcontent-%COMP%]{flex:1;min-width:0}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;margin:0;color:#1f2937}.header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#2563eb}.create-event-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:10px 20px;background-color:#2563eb;color:#fff;border:none;border-radius:8px;cursor:pointer;transition:background-color .2s}.create-event-btn[_ngcontent-%COMP%]:hover{background-color:#1d4ed8}.card[_ngcontent-%COMP%]{background:white;border-radius:12px;padding:25px;box-shadow:0 2px 4px #0000001a;margin-bottom:20px}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px;margin-bottom:20px}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:500;color:#374151}.input-with-icon[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.input-with-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{position:absolute;left:12px;color:#9ca3af}.input-with-icon[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .input-with-icon[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .input-with-icon[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:10px 10px 10px 35px;border:1px solid #d1d5db;border-radius:8px;font-size:.95rem;transition:all .2s}.input-with-icon[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{min-height:100px;resize:vertical}.input-with-icon[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .input-with-icon[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus, .input-with-icon[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:#2563eb;box-shadow:0 0 0 3px #2563eb1a}.error-message[_ngcontent-%COMP%]{color:#dc2626;font-size:.875rem;display:flex;align-items:center;gap:5px}.image-upload-container[_ngcontent-%COMP%]{border:2px dashed #d1d5db;border-radius:8px;padding:20px;text-align:center;cursor:pointer;transition:all .2s}.image-upload-container[_ngcontent-%COMP%]:hover{border-color:#2563eb;background-color:#f8fafc}.image-preview[_ngcontent-%COMP%]{position:relative;max-width:100%;margin-bottom:10px}.image-preview[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;max-height:200px;object-fit:cover;border-radius:8px}.remove-image[_ngcontent-%COMP%]{position:absolute;top:10px;right:10px;background:rgba(0,0,0,.5);color:#fff;border:none;border-radius:50%;width:30px;height:30px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:background-color .2s}.remove-image[_ngcontent-%COMP%]:hover{background:rgba(0,0,0,.7)}.image-upload-area[_ngcontent-%COMP%]{padding:30px}.image-upload-area[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:2rem;color:#2563eb;margin-bottom:10px}.image-upload-area[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0;color:#4b5563}.image-hint[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280}.hidden-input[_ngcontent-%COMP%]{display:none}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:15px;margin-top:30px}.btn-primary[_ngcontent-%COMP%], .btn-secondary[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:10px 20px;border-radius:8px;font-weight:500;cursor:pointer;transition:all .2s}.btn-primary[_ngcontent-%COMP%]{background-color:#2563eb;color:#fff;border:none}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background-color:#1d4ed8}.btn-primary[_ngcontent-%COMP%]:disabled{background-color:#93c5fd;cursor:not-allowed}.btn-secondary[_ngcontent-%COMP%]{background-color:#f3f4f6;color:#4b5563;border:none}.btn-secondary[_ngcontent-%COMP%]:hover{background-color:#e5e7eb}.events-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:20px;padding:20px}.event-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;box-shadow:0 2px 8px #0000001a;overflow:hidden;transition:transform .2s ease,box-shadow .2s ease;margin-bottom:20px;display:flex;flex-direction:column;justify-content:space-between;height:100%}.event-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 4px 12px #00000026}.event-image[_ngcontent-%COMP%]{width:100%;height:200px;overflow:hidden}.event-image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}.event-header[_ngcontent-%COMP%]{padding:15px 20px;border-bottom:1px solid #eee;display:flex;justify-content:space-between;align-items:center}.event-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.2rem;color:#333}.event-status[_ngcontent-%COMP%]{padding:4px 12px;border-radius:20px;font-size:.8rem;font-weight:500}.event-status.upcoming[_ngcontent-%COMP%]{background:#e3f2fd;color:#1976d2}.event-status.ongoing[_ngcontent-%COMP%]{background:#e8f5e9;color:#2e7d32}.event-status.past[_ngcontent-%COMP%]{background:#f5f5f5;color:#757575}.event-status.cancelled[_ngcontent-%COMP%]{background:#ffebee;color:#d32f2f}.event-details[_ngcontent-%COMP%]{flex:1 1 auto;display:flex;flex-direction:column;justify-content:space-between;height:100%;padding:20px}.event-description[_ngcontent-%COMP%]{color:#666;margin-bottom:15px;line-height:1.5}.event-info[_ngcontent-%COMP%]{flex:0 0 auto;margin-bottom:20px;display:grid;grid-template-columns:repeat(2,1fr);gap:15px}.info-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:#555;font-size:.9rem}.info-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#666;font-size:1rem}.event-actions[_ngcontent-%COMP%]{margin-top:auto;display:flex;gap:10px;justify-content:flex-end;align-items:center}.btn-edit[_ngcontent-%COMP%], .btn-delete[_ngcontent-%COMP%], .btn-restore[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px;padding:8px 16px;border:none;border-radius:6px;font-weight:500;cursor:pointer;font-size:1rem;transition:background .2s,color .2s,box-shadow .2s}.btn-edit[_ngcontent-%COMP%]{background:#e3f2fd;color:#1976d2}.btn-edit[_ngcontent-%COMP%]:hover{background:#bbdefb}.btn-delete[_ngcontent-%COMP%]{background:#ffebee;color:#d32f2f}.btn-delete[_ngcontent-%COMP%]:hover{background:#ffcdd2}.btn-restore[_ngcontent-%COMP%]{background:#e8f5e9;color:#2e7d32}.btn-restore[_ngcontent-%COMP%]:hover{background:#c8e6c9}.material-icons[_ngcontent-%COMP%]{font-size:1.2em;vertical-align:middle}.loading-spinner[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:10px;padding:40px;color:#6b7280}.loading-spinner[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.5rem}.no-events[_ngcontent-%COMP%]{text-align:center;padding:40px;color:#6b7280}.no-events[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:3rem;color:#9ca3af;margin-bottom:15px}.alert[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:12px 20px;border-radius:8px;margin-bottom:20px}.alert-error[_ngcontent-%COMP%]{background-color:#fee2e2;color:#dc2626}.alert-success[_ngcontent-%COMP%]{background-color:#dcfce7;color:#166534}.delete-dialog[_ngcontent-%COMP%]{position:fixed;inset:0;background:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;z-index:1000}.delete-dialog-content[_ngcontent-%COMP%]{background:white;padding:24px;border-radius:12px;width:90%;max-width:400px;box-shadow:0 4px 6px #0000001a}.delete-dialog-title[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:600;margin-bottom:16px;color:#1f2937}.delete-dialog-message[_ngcontent-%COMP%]{color:#4b5563;margin-bottom:24px}.delete-dialog-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:12px}.delete-dialog-btn[_ngcontent-%COMP%]{padding:8px 16px;border-radius:6px;font-weight:500;cursor:pointer;transition:all .2s}.delete-dialog-btn.cancel[_ngcontent-%COMP%]{background:#f3f4f6;color:#4b5563;border:none}.delete-dialog-btn.cancel[_ngcontent-%COMP%]:hover{background:#e5e7eb}.delete-dialog-btn.confirm[_ngcontent-%COMP%]{background:#dc2626;color:#fff;border:none}.delete-dialog-btn.confirm[_ngcontent-%COMP%]:hover{background:#b91c1c}@media (max-width: 1024px){.container[_ngcontent-%COMP%]{flex-direction:column}.sidebar[_ngcontent-%COMP%]{width:100%;position:static}.menu[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{display:flex;gap:10px;overflow-x:auto;padding-bottom:10px}.menu[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{white-space:nowrap}}@media (max-width: 640px){.container[_ngcontent-%COMP%]{padding:10px}.form-row[_ngcontent-%COMP%], .events-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.header[_ngcontent-%COMP%]{flex-direction:column;gap:15px;align-items:flex-start}.create-event-btn[_ngcontent-%COMP%]{width:100%;justify-content:center}}@media (max-width: 768px){.events-grid[_ngcontent-%COMP%], .event-info[_ngcontent-%COMP%]{grid-template-columns:1fr}}.material-icons[_ngcontent-%COMP%]{font-family:Material Icons!important;font-weight:400!important;font-style:normal!important;font-size:24px;display:inline-block;line-height:1;text-transform:none;letter-spacing:normal;word-wrap:normal;direction:ltr;-webkit-font-feature-settings:"liga";-webkit-font-smoothing:antialiased}']})}return n})()}}]);